<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>ç™»å½• - æ ¡å›­æµæµªåŠ¨ç‰©æ•‘åŠ©ç³»ç»Ÿ</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Segoe UI','å¾®è½¯é›…é»‘'; height: 100vh; display: flex; justify-content: center; align-items: center; background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab); background-size: 400% 400%; animation: gradientBG 15s ease infinite; }
        @keyframes gradientBG { 0% {background-position:0% 50%} 50% {background-position:100% 50%} 100% {background-position:0% 50%} }
        .login-box { background: rgba(255,255,255,0.85); backdrop-filter: blur(10px); padding: 50px 40px; border-radius: 20px; box-shadow: 0 15px 35px rgba(0,0,0,0.2); width: 400px; text-align: center; animation: slideUp 0.8s ease forwards; opacity: 0; transform: translateY(50px); }
        @keyframes slideUp { to {opacity:1;transform:translateY(0)} }
        .login-header i { font-size: 3em; color: #e73c7e; margin-bottom: 10px; animation: bounce 2s infinite; }
        @keyframes bounce { 0%,100%{transform:translateY(0)} 50%{transform:translateY(-10px)} }
        .input-group { position: relative; margin-bottom: 30px; text-align: left; }
        .input-group i { position: absolute; top: 15px; left: 15px; color: #999; }
        .input-group input { width: 100%; padding: 12px 15px 12px 45px; border: none; background: #f0f2f5; border-radius: 50px; font-size: 16px; outline: none; transition: 0.3s; }
        .input-group input:focus { background: #fff; box-shadow: 0 5px 15px rgba(231,60,126,0.2); transform: scale(1.02); }
        .btn-login { width: 100%; padding: 15px; border: none; border-radius: 50px; background: linear-gradient(90deg, #e73c7e, #23a6d5); color: white; font-size: 18px; font-weight: bold; cursor: pointer; transition: 0.2s; box-shadow: 0 5px 15px rgba(0,0,0,0.2); margin-bottom: 20px; }
        .btn-login:hover { transform: translateY(-3px); box-shadow: 0 8px 20px rgba(0,0,0,0.3); }
        .footer-links a { color: #23a6d5; text-decoration: none; margin: 0 10px; font-weight: 500; }
        .admin-tip { margin-top: 20px; font-size: 12px; color: #999; background: #f8f9fa; padding: 5px; border-radius: 5px; display: inline-block; }
    </style>
</head>
<body>
<div class="login-box">
    <div class="login-header"><i class="fas fa-paw"></i><h2>æ¬¢è¿å›æ¥</h2></div>
    <div class="input-group"><input type="text" id="username" placeholder="è¯·è¾“å…¥ç”¨æˆ·å" autocomplete="off"><i class="fas fa-user"></i></div>
    <div class="input-group"><input type="password" id="password" placeholder="è¯·è¾“å…¥å¯†ç "><i class="fas fa-lock"></i></div>
    <button class="btn-login" onclick="handleLogin()">ç«‹å³ç™»å½•</button>
    <div class="footer-links"><a href="register.html">æ³¨å†Œæ–°è´¦å·</a> | <a href="index.html">è¿”å›é¦–é¡µ</a></div>
    
</div>
<script>
    async function handleLogin() {
        const u = document.getElementById('username').value, p = document.getElementById('password').value, btn = document.querySelector('.btn-login');
        if(!u || !p) return;
        btn.innerText = "ç™»å½•ä¸­..."; btn.disabled = true;
        try {
            const res = await fetch('http://127.0.0.1:8000/login', {method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({username:u,password:p})});
            if(res.ok) {
                const data = await res.json();
                localStorage.setItem('currentUser', JSON.stringify(data));
                btn.style.background = "#28a745"; btn.innerText = "âœ¨ ç™»å½•æˆåŠŸï¼";
                
                // âœ… æ ¸å¿ƒä¿®å¤ï¼šæ ¹æ® role å­—æ®µä¸¥æ ¼åˆ†æµ
                setTimeout(() => { 
                    if (data.role === 'admin') {
                        location.href = 'admin.html'; // ç®¡ç†å‘˜å»åå°
                    } else {
                        location.href = 'home.html';  // å­¦ç”Ÿå»ä¸»é¡µ
                    }
                }, 800);
            } else { alert("ğŸ’” ç™»å½•å¤±è´¥ï¼š" + (await res.json()).detail); resetBtn(); }
        } catch(e) { alert("æœåŠ¡å™¨é”™è¯¯"); resetBtn(); }
        function resetBtn(){ btn.innerText="ç«‹å³ç™»å½•"; btn.disabled=false; btn.style.background=""; }
    }
    document.addEventListener('keydown', function(event) { if(event.key==="Enter") handleLogin(); });
</script>
</body>
</html>